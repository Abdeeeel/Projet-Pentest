<?php
// Démarrer la session
session_start();

require_once "../includes/config.php"; // Assurez-vous que le chemin d'accès est correct

// Vérifier si l'utilisateur est connecté
if (!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true) {
    header("Location: login.php");
    exit;
}

// Réinitialisation des tentatives de connexion
$sql = "UPDATE users SET login_attempts = 0 WHERE id = ?";

if ($stmt = $conn->prepare($sql)) {
    // Lie l'ID de l'utilisateur à la requête
    $stmt->bind_param("i", $_SESSION["id"]);

    // Exécute la requête
    if ($stmt->execute()) {
        // Si la réinitialisation a réussi, redirige vers login.php
        header("Location: login.php");
        exit;
    } else {
        // En cas d'erreur, affiche un message
        echo "Erreur lors de la réinitialisation des tentatives de connexion. Veuillez réessayer.";
    }

    // Ferme le statement
    $stmt->close();
} else {
    // Affiche un message en cas d'erreur de préparation de la requête
    echo "Erreur de préparation : " . $conn->error;
}

// Ferme la connexion
$conn->close();
?>
