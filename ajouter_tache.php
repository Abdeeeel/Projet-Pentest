<?php
include 'includes/config.php'; // Assurez-vous que le chemin est correct

// Récupère les données du formulaire
$titre = $_POST['titre'];
$description = $_POST['description'];
$statut = $_POST['statut'];
$date_echeance = !empty($_POST['date_echeance']) ? $_POST['date_echeance'] : NULL;
$priorite = $_POST['priorite'];
$date_creation = date('Y-m-d H:i:s'); // Obtient la date et l'heure actuelles

// Prépare la requête SQL pour inclure date_creation
$sql = "INSERT INTO taches (titre, description, statut, date_echeance, priorite, date_creation) VALUES (?, ?, ?, ?, ?, ?)";

$stmt = $conn->prepare($sql);
// Lie les paramètres à la requête SQL, en incluant la date_creation
$stmt->bind_param("ssssis", $titre, $description, $statut, $date_echeance, $priorite, $date_creation);

// Exécute la requête
if ($stmt->execute()) {
    echo "Nouvelle tâche ajoutée avec succès";
} else {
    echo "Erreur : " . $stmt->error;
}

$stmt->close();
$conn->close();

// Redirige vers la page principale
header('Location: index.php');
?>
